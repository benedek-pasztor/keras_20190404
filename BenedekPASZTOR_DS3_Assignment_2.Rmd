---
title: 'Data Science 3: Assignment 2'
author: "Benedek P√ÅSZTOR"
date: "April 5, 2019"
output: html_document
---

## Deep neural nets with `keras`

The [homepage](https://keras.rstudio.com/) has great descrpitions, expamples
and tutorials. Cheatsheet [here](https://www.rstudio.com/resources/cheatsheets/). 

```{r}
# install.packages("keras")
library(keras)
# install_keras()
```

  
```{r}
library(keras)
library(here)
library(grid)
library(magick)  # not absolutely necessary
```

```{r}
mnist <- dataset_mnist()
x_train <- mnist$train$x
y_train <- mnist$train$y
x_test <- mnist$test$x
y_test <- mnist$test$y
```

```{r, fig.width=2, fig.height=2}
show_mnist_image <- function(x) {
  image(1:28, 1:28, t(x)[,nrow(x):1],col=gray((0:255)/255)) 
}

show_mnist_image(x_train[18, , ])
```


```{r}
fashion_mnist <- dataset_fashion_mnist()
x_train <- fashion_mnist$train$x
y_train <- fashion_mnist$train$y
x_test <- fashion_mnist$test$x
y_test <- fashion_mnist$test$y

```




### a. Show some example images from the data.


### b. Train a fully connected deep network to predict items.


##### - Normalize the data similarly to what we saw with MNIST.


##### - Experiment with network architectures and settings (number of hidden layers, number of nodes, activation functions, dropout, etc.)


##### - Explain what you have tried, what worked and what did not. Present a final model.


##### - Make sure that you use enough epochs so that the validation error starts flattening out - provide a plot about the training history (plot(history))


##### - Evaluate the model on the test set. How does test error compare to validation error?


### c. Try building a convolutional neural network and see if you can improve test set performance.


### d. Just like before, experiment with different network architectures, regularization techniques and present your findings



# 2. Hot dog or not hot dog?

### a. Pre-process data so that it is acceptable by Keras (set folder structure, bring images to the same size, etc).

### b. Estimate a convolutional neural network to predict if an image contains a hot dog or not. Evaluate your model on the test set.

### c. Could data augmentation techniques help with achieving higher predictive accuracy? Try some augmentations that you think make sense and compare

### d. Try to rely on some pre-built neural networks to aid prediction. Can you achieve a better performance using transfer learning for this problem?